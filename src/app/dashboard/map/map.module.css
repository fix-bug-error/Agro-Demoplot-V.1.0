.mapContainer {
  position: relative;
  height: 100%;
  width: 100%;
  border-radius: 0.5rem;
  /* Ensure the map doesn't overlap with header and sidebar */
  z-index: 1;
  /* Prevent map from extending beyond its container */
  overflow: hidden;
  /* Ensure the map container respects its parent's boundaries */
  max-width: 100%;
  /* Prevent scrolling conflicts on mobile */
  touch-action: pan-x pan-y;
  /* Ensure map container doesn't interfere with page layout */
  contain: layout style paint;
  /* Prevent map from capturing scroll gestures */
  scroll-behavior: auto;
}

/* Mobile-specific adjustments */
@media (max-width: 768px) {
  .mapContainer {
    /* Ensure map stays within its container */
    position: relative;
    /* Ensure map respects mobile screen boundaries */
    max-width: 100vw;
    /* Ensure proper positioning on mobile */
    touch-action: manipulation;
    /* Prevent map from capturing scroll events */
    overscroll-behavior: contain;
    /* Ensure map container respects mobile constraints */
    contain: layout style paint;
    /* Prevent map from interfering with page scroll */
    scroll-behavior: auto;
    /* Reset any margin that might cause vertical shift */
    margin: 0;
    /* Reset any padding that might cause vertical shift */
    padding: 0;
  }
  
  /* Ensure map controls don't overlap with header */
  .mapContainer :global(.leaflet-top) {
    top: 10px;
    /* Ensure controls don't overlap with mobile UI */
    z-index: 500;
  }
  
  /* Adjust map controls for mobile */
  .mapContainer :global(.leaflet-control) {
    z-index: 500;
  }
  
  /* Make sure popup tooltips don't extend beyond map area */
  .mapContainer :global(.leaflet-popup) {
    z-index: 600;
    /* Ensure popups stay within map bounds on mobile */
    max-width: 90vw;
  }
  
  /* Adjust for mobile header height */
  .mapContainer :global(.leaflet-top.leaflet-left) {
    top: 10px;
  }
  
  /* Ensure all map elements respect container boundaries */
  .mapContainer :global(.leaflet-container) {
    position: relative;
    z-index: 10;
    /* Prevent map from extending beyond mobile screen */
    max-width: 100%;
    width: 100%;
    height: 100%;
    /* Ensure proper touch handling on mobile */
    touch-action: manipulation;
    /* Prevent map from capturing scroll events */
    overscroll-behavior: contain;
    /* Ensure container respects mobile constraints */
    contain: layout style paint;
    /* Prevent map from interfering with page scroll */
    scroll-behavior: auto;
  }
  
  /* Adjust map panes to respect container boundaries */
  .mapContainer :global(.leaflet-map-pane) {
    z-index: 10;
  }
  
  .mapContainer :global(.leaflet-pane) {
    z-index: 10;
  }
  
  /* Ensure marker popups don't extend beyond map area */
  .mapContainer :global(.leaflet-popup-pane) {
    z-index: 700;
  }
  
  /* Prevent any leaflet controls from extending beyond container */
  .mapContainer :global(.leaflet-control-container) {
    z-index: 800;
  }
  
  /* Ensure map controls are properly sized on mobile */
  .mapContainer :global(.leaflet-bar a) {
    width: 30px;
    height: 30px;
    line-height: 30px;
  }
  
  /* Adjust popup positioning on mobile */
  .mapContainer :global(.leaflet-popup) {
    position: absolute;
  }
  
  /* Ensure tooltips are readable on mobile */
  .mapContainer :global(.leaflet-tooltip) {
    font-size: 12px;
    padding: 6px 10px;
  }
  
  /* Adjust attribution for mobile */
  .mapContainer :global(.leaflet-control-attribution) {
    font-size: 10px;
    padding: 0 5px;
  }
  
  /* Ensure proper control spacing on mobile */
  .mapContainer :global(.leaflet-bar) {
    box-shadow: 0 1px 5px rgba(0,0,0,0.4);
    border-radius: 4px;
  }
  
  .mapContainer :global(.leaflet-bar a) {
    border-bottom: 1px solid #ccc;
  }
  
  .mapContainer :global(.leaflet-bar a:last-child) {
    border-bottom: none;
  }
  
  /* Ensure toggle button appears below header on mobile */
  .mapContainer + button,
  .mapContainer ~ button {
    z-index: 20;
  }
}

/* Ensure the map container respects its boundaries on all screen sizes */
.mapContainer :global(.leaflet-container) {
  position: relative;
  z-index: 10;
  width: 100%;
  height: 100%;
  /* Prevent map from capturing scroll events */
  overscroll-behavior: contain;
  /* Ensure container respects constraints */
  contain: layout style paint;
  /* Prevent map from interfering with page scroll */
  scroll-behavior: auto;
}

/* Adjust map panes to respect container boundaries */
.mapContainer :global(.leaflet-map-pane) {
  z-index: 10;
}

.mapContainer :global(.leaflet-pane) {
  z-index: 10;
}

/* Ensure marker popups don't extend beyond map area */
.mapContainer :global(.leaflet-popup-pane) {
  z-index: 700;
}

/* Ensure map controls don't extend beyond container */
.mapContainer :global(.leaflet-control) {
  z-index: 800;
}

/* Ensure popup tooltips stay within bounds */
.mapContainer :global(.leaflet-tooltip) {
  z-index: 900;
}

/* Ensure attribution stays within bounds */
.mapContainer :global(.leaflet-control-attribution) {
  z-index: 800;
}

/* Ensure map doesn't interfere with page scrolling */
.mapContainer :global(.leaflet-container) {
  scroll-behavior: auto;
}

/* Keep zoom control in default position (top right) with minimal styling */
.mapContainer :global(.leaflet-control-zoom) {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* Ensure popup content is readable */
.mapContainer :global(.leaflet-popup-content-wrapper) {
  border-radius: 8px;
  padding: 2px;
}

.mapContainer :global(.leaflet-popup-content) {
  margin: 10px 16px;
  font-size: 14px;
  line-height: 1.4;
}

/* Ensure map tiles load properly */
.mapContainer :global(.leaflet-tile-container) {
  transform-origin: 0 0;
}

/* Ensure map markers are visible */
.mapContainer :global(.leaflet-marker-icon) {
  z-index: 600;
}

/* Ensure map shadows are properly rendered */
.mapContainer :global(.leaflet-marker-shadow) {
  z-index: 500;
}

/* Ensure gesture handling controls are visible */
.mapContainer :global(.leaflet-gesture-handling-icon) {
  width: 40px;
  height: 40px;
  background-size: 40px 40px;
}

.mapContainer :global(.leaflet-gesture-handling-error) {
  background-color: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 10px;
  border-radius: 4px;
  font-size: 14px;
  text-align: center;
  z-index: 1000;
}

/* Ensure gesture handling instructions are readable */
.mapContainer :global(.leaflet-gesture-handling-instructions) {
  background-color: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 10px;
  border-radius: 4px;
  font-size: 14px;
  text-align: center;
  z-index: 1000;
}

/* Fix for toggle button positioning - moved to top right to avoid conflict */
.mapContainer + button,
.mapContainer ~ button {
  z-index: 20;
  background: white;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  transition: all 0.2s ease;
  color: #333;
}

.mapContainer + button:hover,
.mapContainer ~ button:hover {
  background: #f5f5f5;
}

/* Dark mode support for toggle button */
:global(.dark) .mapContainer + button,
:global(.dark) .mapContainer ~ button {
  background: #2d3748;
  border: 1px solid #4a5568;
  color: #e2e8f0;
}

:global(.dark) .mapContainer + button:hover,
:global(.dark) .mapContainer ~ button:hover {
  background: #4a5568;
}

/* Media query for system preference dark mode */
@media (prefers-color-scheme: dark) {
  .mapContainer + button,
  .mapContainer ~ button {
    background: #2d3748;
    border: 1px solid #4a5568;
    color: #e2e8f0;
  }
  
  .mapContainer + button:hover,
  .mapContainer ~ button:hover {
    background: #4a5568;
  }
}